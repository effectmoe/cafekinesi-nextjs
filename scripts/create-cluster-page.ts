import { createClient } from '@sanity/client'
import { config } from 'dotenv'
import { resolve } from 'path'

// .env.localファイルから環境変数を読み込む
config({ path: resolve(__dirname, '../.env.local') })

// Sanityクライアントの設定
const client = createClient({
  projectId: 'e4aqw590',
  dataset: 'production',
  apiVersion: '2024-01-01',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false
})

async function createClusterPage() {
  try {
    console.log('🚀 クラスターページコンテンツを作成中...')

    // kinesi1-clusterのコンテンツ
    const clusterPageData = {
      _type: 'course',
      courseId: 'kinesi1-cluster',
      title: 'カフェキネシⅠ（クラスター）',
      subtitle: '基礎セラピー講座 - 完全ガイド',
      description: 'カフェキネシⅠは、初心者から始められる基礎セラピー講座です。筋肉反射テストを使った独自のアプローチで、心と体のバランスを整える技術を習得します。この講座では、理論から実践まで体系的に学び、日常生活やセラピストとしての活動に活かせるスキルを身につけることができます。',

      // 基本設定
      order: 0,
      isActive: true,
      isClusterPage: true, // クラスターページフラグ
      courseType: 'main',
      backgroundClass: 'album-beige',

      // 特徴
      features: [
        '初心者でも安心して学べる体系的なカリキュラム',
        '筋肉反射テストの基礎から実践まで習得',
        '経験豊富なインストラクターによる丁寧な指導',
        '少人数制で一人ひとりに合わせたサポート',
        '修了後も継続的なフォローアップあり'
      ],

      // おすすめ対象者
      recommendations: [
        'ヒーリングやセラピーに興味がある方',
        '自分自身や家族のケアに役立てたい方',
        'セラピストとしてスキルアップしたい方',
        '心と体のバランスを整えたい方',
        '新しい学びにチャレンジしたい方'
      ],

      // 受講後の効果
      effects: [
        '筋肉反射テストの技術を習得できる',
        'セルフケアの方法が身につく',
        '家族や友人のサポートができるようになる',
        '心身のバランス調整スキルが向上する',
        'セラピストとしての基礎が固まる'
      ],

      // 料金
      price: {
        amount: 45000,
        unit: '円',
        note: '税込、テキスト代込み'
      },

      // 講座時間
      duration: {
        hours: 18,
        sessions: 3,
        note: '全3回、1回6時間'
      },

      // 目次
      tableOfContents: [
        'カフェキネシとは',
        '講座カリキュラム',
        'こんな方におすすめ',
        '受講後の効果',
        'よくある質問（FAQ）',
        '関連講座のご案内',
        'お申込み方法'
      ],

      // 詳細セクション
      sections: [
        {
          id: 'about',
          title: 'カフェキネシとは',
          content: `カフェキネシオロジーは、筋肉反射テストを用いたユニークなセラピー技法です。カフェのようなリラックスした雰囲気の中で、気軽に学べることからこの名前がつけられました。

伝統的なキネシオロジーの理論をベースに、日本人の体質や文化に合わせて開発された独自のメソッドで、初心者でも無理なく技術を習得できるよう工夫されています。

筋肉反射テストを通じて体の声を聴き、エネルギーバランスを整えることで、心身の健康をサポートします。セラピストとしての技術習得はもちろん、日常のセルフケアとしても活用できる実践的な内容です。`
        },
        {
          id: 'curriculum',
          title: '講座カリキュラム',
          content: `【第1回】筋肉反射テストの基礎
・筋肉反射テストとは
・正しいテスト方法の習得
・エネルギーバランスの概念
・実践練習とフィードバック

【第2回】調整技術の習得
・チャクラとエネルギーポイント
・バランス調整の基本技術
・感情とエネルギーの関係
・実践セッション体験

【第3回】統合と実践
・総合的な調整法
・セッションの組み立て方
・ケーススタディ
・修了認定と今後のステップ

各回とも理論と実践をバランスよく学び、確実にスキルを身につけられるカリキュラムです。`
        },
        {
          id: 'instructor',
          title: 'インストラクターについて',
          content: `経験豊富な認定インストラクターが、一人ひとりのペースに合わせて丁寧に指導します。15年以上の実践経験を持ち、1000名以上の生徒を指導してきた実績があります。

初心者の方でも安心して学べるよう、わかりやすい説明と十分な練習時間を確保。疑問点はその場で解決できる環境を整えています。`
        }
      ],

      // FAQセクション（クラスターページの重要要素）
      faq: [
        {
          question: 'この講座は初心者でも受講できますか？',
          answer: 'はい、全くの初心者の方でも安心して受講いただけます。カフェキネシⅠは基礎講座として設計されており、予備知識は一切必要ありません。経験豊富なインストラクターが一人ひとりのペースに合わせて丁寧に指導しますので、初めての方でも確実にスキルを習得できます。'
        },
        {
          question: '受講資格や必要な知識はありますか？',
          answer: '特別な受講資格や事前知識は必要ありません。20歳以上の方であれば、どなたでも受講いただけます。医療従事者やセラピスト以外の一般の方も多数受講されており、それぞれの目的に応じて学びを深めています。'
        },
        {
          question: 'オンラインでの受講は可能ですか？',
          answer: '現在、カフェキネシⅠは対面形式のみでの開講となっております。筋肉反射テストは繊細な感覚が重要となるため、インストラクターが直接指導できる対面形式を採用しています。ただし、基礎を習得された方向けのフォローアップ講座ではオンライン対応も検討中です。'
        },
        {
          question: '講座の期間はどのくらいですか？',
          answer: '全3回、各回6時間の講座で、合計18時間のプログラムです。通常は月に1回のペースで3ヶ月間かけて学びますが、集中コースでは3週連続での受講も可能です。ご自身のスケジュールに合わせてお選びいただけます。'
        },
        {
          question: '修了後に資格は取得できますか？',
          answer: 'はい、全3回の講座を修了し、最終日の実技チェックに合格された方には、カフェキネシⅠ修了証を発行いたします。この修了証は、上位講座であるカフェキネシアドバンスやインストラクター認定講座を受講する際の必須条件となります。'
        },
        {
          question: '実践的なスキルは身につきますか？',
          answer: 'はい、理論だけでなく実践を重視したカリキュラムです。各回とも十分な練習時間を設けており、修了時には自分自身や家族、友人に対してセッションができるレベルまでスキルを習得できます。また、修了後も定期的な練習会やフォローアップ講座で継続的にサポートします。'
        },
        {
          question: '他のキネシオロジー講座との違いは何ですか？',
          answer: 'カフェキネシは日本人の体質や文化に合わせて開発された独自のメソッドです。欧米発祥の伝統的なキネシオロジーと比べて、より繊細で優しいアプローチを採用しており、初心者でも取り組みやすい内容となっています。また、カフェのようなリラックスした雰囲気で学べる点も特徴です。'
        },
        {
          question: '受講料の分割払いは可能ですか？',
          answer: 'はい、分割払いに対応しております。3回払いまで手数料無料でご利用いただけます。詳細はお申込み時にご相談ください。また、早期申込割引や再受講割引制度もご用意しています。'
        }
      ],

      // AI最適化
      aiSearchKeywords: [
        'カフェキネシ',
        '基礎講座',
        '初心者向け',
        'キネシオロジー',
        'セラピー',
        '筋肉反射テスト',
        'エネルギーバランス'
      ],
      aiQuickAnswer: 'カフェキネシⅠは初心者から始められる基礎セラピー講座です。筋肉反射テストを使った独自のアプローチで、全3回18時間で基礎から実践まで学べます。',
      conversationalQueries: [
        'どんな講座？',
        '初心者でも大丈夫？',
        '何が学べる？',
        '費用はいくら？',
        '期間は？'
      ],
      topicClusters: [
        'キネシオロジー',
        'ヒーリング技術',
        'セラピー講座',
        '基礎セラピー'
      ],
      intentType: 'informational'
    }

    // ドキュメントの作成または更新
    const result = await client.createOrReplace({
      ...clusterPageData,
      _id: 'kinesi1-cluster'
    })

    console.log('✅ クラスターページの作成に成功しました！')
    console.log('📝 ドキュメントID:', result._id)
    console.log('📊 FAQアイテム数:', result.faq?.length || 0)
    console.log('🔗 Sanity Studio:', `https://cafekinesi.sanity.studio/structure/course;kinesi1-cluster`)

  } catch (error) {
    console.error('❌ エラーが発生しました:', error)
    throw error
  }
}

// スクリプト実行
createClusterPage()
  .then(() => {
    console.log('\n🎉 すべての処理が完了しました！')
    process.exit(0)
  })
  .catch((error) => {
    console.error('\n💥 処理が失敗しました:', error)
    process.exit(1)
  })
