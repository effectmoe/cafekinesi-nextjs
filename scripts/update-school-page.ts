/**
 * 既存schoolPageドキュメントにピラーページコンテンツを追加
 */

import { config } from 'dotenv'
import { resolve } from 'path'
import { createClient } from '@sanity/client'

config({ path: resolve(process.cwd(), '.env.local') })

const client = createClient({
  projectId: 'e4aqw590',
  dataset: 'production',
  apiVersion: '2024-01-01',
  token: process.env.SANITY_API_TOKEN,
  useCdn: false,
})

async function main() {
  console.log('🚀 schoolPageドキュメントを更新中...\n')

  try {
    // 既存のschoolPageを取得
    const existingPage = await client.fetch(`*[_type == "schoolPage"][0]`)

    if (!existingPage) {
      console.log('❌ schoolPageが見つかりません')
      process.exit(1)
    }

    console.log(`✅ 既存のschoolPage見つかりました: ${existingPage._id}\n`)

    // ピラーページコンテンツを追加
    const updatedPage = {
      ...existingPage,
      selectionGuide: {
        title: 'あなたに合った講座の選び方',
        description: `カフェキネシオロジーでは、初心者から上級者まで、レベルに応じた講座を多数ご用意しています。
自分に合った講座を選ぶことで、効率的にスキルアップできます。
以下のポイントを参考に、あなたにぴったりの講座を見つけてください。`,
        points: [
          {
            title: '目的を明確にする',
            description: `まずは、キネシオロジーを学ぶ目的を明確にしましょう。自己ケアのためなのか、プロとして活動したいのか、目的によって選ぶべき講座が変わってきます。`,
          },
          {
            title: 'レベルに応じて選ぶ',
            description: `初めての方はレベル1から順番に受講することをおすすめします。基礎をしっかり固めることで、応用講座の理解が深まります。`,
          },
          {
            title: '興味のある分野から始める',
            description: `キネシオロジーには様々な分野があります。ストレスケア、痛みの軽減、感情の解放など、興味のある分野から始めると学習意欲が高まります。`,
          },
        ],
      },
      learningFlow: {
        title: '学習の流れ・ステップ',
        description: `カフェキネシオロジーの講座は、段階的に学べるよう体系化されています。
基礎から応用、そして実践へと、無理なくスキルアップできるカリキュラムです。`,
        steps: [
          {
            number: 1,
            title: '基礎講座で土台を作る',
            description: `まずはレベル1の基礎講座から始めましょう。筋反射テストの基本、エネルギーバランスの取り方など、キネシオロジーの基本技術を習得します。少人数制なので、初心者の方でも安心して学べます。`,
          },
          {
            number: 2,
            title: '応用講座でスキルを深める',
            description: `基礎が身についたら、応用講座へ進みましょう。ストレス解放、感情のバランス調整、痛みへのアプローチなど、より実践的な技術を学びます。実際のケーススタディを通じて、技術の応用力を養います。`,
          },
          {
            number: 3,
            title: '発展講座でプロフェッショナルへ',
            description: `プロとして活動したい方は、発展講座へ。クライアントへの対応方法、セッションの組み立て方、ビジネスとしての展開方法まで、実践的なスキルを総合的に学びます。`,
          },
          {
            number: 4,
            title: '継続的な学びとコミュニティ',
            description: `講座修了後も、定期的な勉強会やフォローアップセッションを開催しています。技術の復習、新しい知識の習得、そして仲間とのつながりを大切にしながら、継続的に成長していけます。`,
          },
        ],
      },
      faq: {
        title: 'よくある質問',
        items: [
          {
            question: 'キネシオロジーの経験がなくても受講できますか？',
            answer: `はい、もちろん可能です。レベル1の基礎講座は、キネシオロジーが初めての方を対象としています。専門知識は一切不要で、どなたでも気軽に始めていただけます。講師が丁寧にサポートしますので、安心してご受講ください。`,
          },
          {
            question: '講座の受講期間はどのくらいですか？',
            answer: `講座によって異なりますが、基礎講座（レベル1）は通常2日間（合計12時間）です。応用講座や発展講座は、内容に応じて3〜5日間のカリキュラムとなっています。短期集中型と週末分散型の両方をご用意していますので、ライフスタイルに合わせてお選びいただけます。`,
          },
          {
            question: '受講料の支払い方法を教えてください',
            answer: `銀行振込、クレジットカード決済に対応しています。また、複数講座を同時にお申し込みいただく場合は、セット割引がございます。詳しくは各講座ページをご確認いただくか、お問い合わせフォームからご連絡ください。`,
          },
          {
            question: '仕事をしながらでも受講できますか？',
            answer: `はい、多くの受講生が仕事をしながら学ばれています。週末開催の講座や、平日夜間のオンライン講座もございます。また、録画視聴できる講座もありますので、忙しい方でも自分のペースで学習を進めることができます。`,
          },
          {
            question: '資格は取得できますか？',
            answer: `はい、各講座の修了後に修了証を発行しています。また、すべての必須講座を修了し、実技試験に合格された方には、「カフェキネシオロジープラクティショナー」の認定資格を授与しています。この資格があれば、プロとしてセッションを提供することができます。`,
          },
          {
            question: 'オンライン受講と対面受講の違いは？',
            answer: `オンライン講座は、全国どこからでも受講でき、移動時間やコストを抑えられるメリットがあります。一方、対面講座は、直接指導を受けられ、実技の細かいニュアンスを学びやすいという利点があります。基礎講座は対面を推奨していますが、応用講座以降はオンラインでも十分に学べる内容です。`,
          },
          {
            question: '年齢制限はありますか？',
            answer: `特に年齢制限は設けておりません。20代から70代まで、幅広い年齢層の方が受講されています。大切なのは学ぶ意欲です。ただし、18歳未満の方は保護者の同意が必要となります。`,
          },
          {
            question: '講座をキャンセルした場合、返金はありますか？',
            answer: `開講日の14日前までのキャンセルは、事務手数料（受講料の10%）を差し引いた金額を返金いたします。それ以降のキャンセルについては、次回開講の講座への振替が可能です。詳しくは受講規約をご確認ください。`,
          },
        ],
      },
      certification: {
        title: '資格・認定について',
        description: `カフェキネシオロジーでは、講座修了後に認定資格を取得できます。
プロフェッショナルとして活動したい方はもちろん、自己成長の証としても価値のある資格です。
認定を受けることで、確かな技術と知識を持つプラクティショナーとして活動できます。`,
        benefits: [
          '修了証・認定証の発行',
          'プロとしての信頼性向上',
          '認定プラクティショナーとしてサイト掲載',
          '継続教育プログラムへの参加資格',
          '認定者限定の勉強会・交流会参加',
          'ビジネスサポート（集客・マーケティング支援）',
        ],
      },
    }

    // 更新を実行
    const result = await client
      .patch(existingPage._id)
      .set({
        selectionGuide: updatedPage.selectionGuide,
        learningFlow: updatedPage.learningFlow,
        faq: updatedPage.faq,
        certification: updatedPage.certification,
      })
      .commit()

    console.log('✅ schoolPageの更新が完了しました！')
    console.log(`   ドキュメントID: ${result._id}\n`)

    console.log('📝 追加されたコンテンツ:')
    console.log('   ✅ 講座の選び方ガイド（3ポイント）')
    console.log('   ✅ 学習の流れ（4ステップ）')
    console.log('   ✅ よくある質問（8項目）')
    console.log('   ✅ 資格・認定（6つのメリット）\n')

    console.log('🎨 次のステップ: Sanity MCPで画像を生成')

  } catch (error) {
    console.error('❌ エラーが発生しました:', error)
    process.exit(1)
  }
}

main()
